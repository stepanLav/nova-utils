name: README build

on:
  push:
    branches:
      - master

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout current repository to Master branch
        uses: actions/checkout@v1

      - name: Get changed files
        id: changed-files
        uses: tj-actions/changed-files@v18.2
        with:
          files: chains/v2/chains.json

      - name: Install dependencies
        if: steps.changed-files.outputs.only_changed == 'true'
        run: pip install -r requirements.txt
      - name: Generate README file
        if: steps.changed-files.outputs.only_changed == 'true'
        run: python ./scripts/generate-readme.py

      - name: Create Pull Request
        if: steps.changed-files.outputs.only_changed == 'true'
        uses: peter-evans/create-pull-request@v3
        with:
          title: 'Update network list'
          body: |
            Update networks list in https://github.com/nova-wallet/nova-utils/tree/master/chains
            - Auto-generated by [create-pull-request][1]
          assignees: stepanLav
